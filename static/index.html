<!doctype html>
<html lang="en">
    <head>
        <link rel="stylesheet" type="text/css" href="style.css" />
        <link rel="stylesheet" href="/codemirror/lib/codemirror.css">
        <link rel="stylesheet" href="/codemirror/addon/lint/lint.css">
        <script type="text/javascript" src="/codemirror/lib/codemirror.js"></script>
        <script type="text/javascript" src="/codemirror/addon/mode/simple.js"></script>
        <script type="text/javascript" src="/editor.js"></script>
        <meta charset="utf-8">
        <title>Biscuit tokens playground by Clever Cloud</title>
        <script type="module">
          /*import init from "./wasm.js"
            init()
            */
        </script>
    </head>
    <body>
      <div>
        <div id="header">
            <a href="https://www.clever-cloud.com/"><img src="/logo.svg" /></a>
            <h2>Biscuit Token playground</h2>
        </div>
        <div id="biscuit-wrapper">
            <div id="explain">
                <p>This is a live demo of the <a href="https://github.com/CleverCloud/biscuit">Biscuit authentication and authorization tokens</a>,
                  where you can test different authorization policies. Each token
                  is made of blocks, each block represents one attenuation level:
                  you can restrict the rights of a token by adding a new block.
                  Authorization policies are written in Datalog, where facts represent
                  data, rules generate more facts from existing facts, and checks
                  validate the presence of some facts. To pass the verification
                  phase, all of the checks must succeed.
                </p>
                <p>Test the behaviour of the example token by activating or
                  deactivating blocks or their data, changing conditions (like
                  <em>#read</em> operation to <em>#write</em> and see how the verifier will react)</p>
            </div>

            <div id="token" class="container">
                <h3>Token</h3>
                <ul id="block-list">
                    <li><button onclick="add_block()">Add Block</button></li>
                </ul>
                <div class="sub-container">
                    <em>Token content</em>
                    <!--<input
                        type="text"
                        size="45"
                        value ="self.token.serialized.as_deref().unwrap_or"
                        />-->
                    <pre id="token-content">
                    </pre>
                </div>
            </div>
            <div id="verifier" class="container">
              <h3>Verifier</h3>

              <div class="sub-container">
                  <textarea
                      class="code"
                      id="verifier-code"
                      oninput="contentUpdate()"
                  ></textarea>
              </div>

              <div class="sub-container">
                  <h4>Verifier result</h4>
                  <p id="verifier-result">
                  </p>

                  <pre id="verifier-world"></pre>
              </div>

          </div>
        </div>
    </div>  
    <script type="module" src="/demo.js"></script>

    </body>
</html>
